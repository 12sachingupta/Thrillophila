"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7052],{87052:function(Vn,Qt,de){de.d(Qt,{j:function(){return Mn}});var F,z,Q,fe,Oe,f,q,R,N,W,ie,ct=function(n,e){return(ct=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(t[r]=i[r])})(n,e)};function G(n,e){if(typeof e!="function"&&e!==null)throw TypeError("Class extends value "+String(e)+" is not a constructor or null");function t(){this.constructor=n}ct(n,e),n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var h=function(){return(h=Object.assign||function(n){for(var e,t=1,i=arguments.length;t<i;t++)for(var r in e=arguments[t])Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}).apply(this,arguments)};function Pe(n,e){var t={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&0>e.indexOf(i)&&(t[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(n);r<i.length;r++)0>e.indexOf(i[r])&&Object.prototype.propertyIsEnumerable.call(n,i[r])&&(t[i[r]]=n[i[r]]);return t}function p(n,e,t,i){return new(t||(t=Promise))(function(r,s){function o(d){try{l(i.next(d))}catch(u){s(u)}}function c(d){try{l(i.throw(d))}catch(u){s(u)}}function l(d){var u;d.done?r(d.value):((u=d.value)instanceof t?u:new t(function(a){a(u)})).then(o,c)}l((i=i.apply(n,e||[])).next())})}function v(n,e){var t,i,r,s,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return s={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function c(l){return function(d){return function(u){if(t)throw TypeError("Generator is already executing.");for(;s&&(s=0,u[0]&&(o=0)),o;)try{if(t=1,i&&(r=2&u[0]?i.return:u[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,u[1])).done)return r;switch(i=0,r&&(u=[2&u[0],r.value]),u[0]){case 0:case 1:r=u;break;case 4:return o.label++,{value:u[1],done:!1};case 5:o.label++,i=u[1],u=[0];continue;case 7:u=o.ops.pop(),o.trys.pop();continue;default:if(!(r=(r=o.trys).length>0&&r[r.length-1])&&(u[0]===6||u[0]===2)){o=0;continue}if(u[0]===3&&(!r||u[1]>r[0]&&u[1]<r[3])){o.label=u[1];break}if(u[0]===6&&o.label<r[1]){o.label=r[1],r=u;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(u);break}r[2]&&o.ops.pop(),o.trys.pop();continue}u=e.call(n,o)}catch(a){u=[6,a],i=0}finally{t=r=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([l,d])}}}function re(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],i=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&i>=n.length&&(n=void 0),{value:n&&n[i++],done:!n}}};throw TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function U(n,e){var t=typeof Symbol=="function"&&n[Symbol.iterator];if(!t)return n;var i,r,s=t.call(n),o=[];try{for(;(e===void 0||e-- >0)&&!(i=s.next()).done;)o.push(i.value)}catch(c){r={error:c}}finally{try{i&&!i.done&&(t=s.return)&&t.call(s)}finally{if(r)throw r.error}}return o}function $(n,e,t){if(t||arguments.length==2)for(var i,r=0,s=e.length;r<s;r++)!i&&r in e||(i||(i=Array.prototype.slice.call(e,0,r)),i[r]=e[r]);return n.concat(i||Array.prototype.slice.call(e))}typeof SuppressedError=="function"&&SuppressedError,(F=q||(q={}))[F.None=0]="None",F[F.Error=1]="Error",F[F.Warn=2]="Warn",F[F.Verbose=3]="Verbose",F[F.Debug=4]="Debug";var E=function(n){return function(){var e=h({},n.config);return{logger:e.loggerProvider,logLevel:e.logLevel}}},$t=function(n,e){var t,i;e=(e=e.replace(/\[(\w+)\]/g,".$1")).replace(/^\./,"");try{for(var r=re(e.split(".")),s=r.next();!s.done;s=r.next()){var o=s.value;if(!(o in n))return;n=n[o]}}catch(c){t={error:c}}finally{try{s&&!s.done&&(i=r.return)&&i.call(r)}finally{if(t)throw t.error}}return n},T=function(n,e){return function(){var t,i,r={};try{for(var s=re(e),o=s.next();!o.done;o=s.next()){var c=o.value;r[c]=$t(n,c)}}catch(l){t={error:l}}finally{try{o&&!o.done&&(i=s.return)&&i.call(s)}finally{if(t)throw t.error}}return r}},k=function(n,e,t,i,r){return r===void 0&&(r=null),function(){for(var s=[],o=0;o<arguments.length;o++)s[o]=arguments[o];var c=t(),l=c.logger,d=c.logLevel;if(d&&d<q.Debug||!d||!l)return n.apply(r,s);var u={type:"invoke public method",name:e,args:s,stacktrace:(Error().stack||"").split(`
`).slice(3).map(function(g){return g.trim()}),time:{start:new Date().toISOString()},states:{}};i&&u.states&&(u.states.before=i());var a=n.apply(r,s);return a&&a.promise?a.promise.then(function(){i&&u.states&&(u.states.after=i()),u.time&&(u.time.end=new Date().toISOString()),l.debug(JSON.stringify(u,null,2))}):(i&&u.states&&(u.states.after=i()),u.time&&(u.time.end=new Date().toISOString()),l.debug(JSON.stringify(u,null,2))),a}},L=function(n){return{promise:n||Promise.resolve()}};(z=R||(R={})).Unknown="unknown",z.Skipped="skipped",z.Success="success",z.RateLimit="rate_limit",z.PayloadTooLarge="payload_too_large",z.Invalid="invalid",z.Failed="failed",z.Timeout="Timeout",z.SystemError="SystemError";var Kt="".concat("AMP","_unsent"),lt="https://api2.amplitude.com/2/httpapi",Bt=function(n,e){var t=Math.max(e,1);return n.reduce(function(i,r,s){var o=Math.floor(s/t);return i[o]||(i[o]=[]),i[o].push(r),i},[])},oe=function(n,e,t){return e===void 0&&(e=0),t===void 0&&(t=R.Unknown),{event:n,code:e,message:t}},_e="Amplitude Logger ",dt=function(){function n(){this.logLevel=q.None}return n.prototype.disable=function(){this.logLevel=q.None},n.prototype.enable=function(e){e===void 0&&(e=q.Warn),this.logLevel=e},n.prototype.log=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.logLevel<q.Verbose||console.log("".concat(_e,"[Log]: ").concat(e.join(" ")))},n.prototype.warn=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.logLevel<q.Warn||console.warn("".concat(_e,"[Warn]: ").concat(e.join(" ")))},n.prototype.error=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.logLevel<q.Error||console.error("".concat(_e,"[Error]: ").concat(e.join(" ")))},n.prototype.debug=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.logLevel<q.Debug||console.log("".concat(_e,"[Debug]: ").concat(e.join(" ")))},n}(),Ie=function(){return{flushMaxRetries:12,flushQueueSize:200,flushIntervalMillis:1e4,instanceName:"$default_instance",logLevel:q.Warn,loggerProvider:new dt,offline:!1,optOut:!1,serverUrl:lt,serverZone:"US",useBatch:!1}},zt=function(){function n(e){this._optOut=!1;var t,i,r,s,o=Ie();this.apiKey=e.apiKey,this.flushIntervalMillis=(t=e.flushIntervalMillis)!==null&&t!==void 0?t:o.flushIntervalMillis,this.flushMaxRetries=e.flushMaxRetries||o.flushMaxRetries,this.flushQueueSize=e.flushQueueSize||o.flushQueueSize,this.instanceName=e.instanceName||o.instanceName,this.loggerProvider=e.loggerProvider||o.loggerProvider,this.logLevel=(i=e.logLevel)!==null&&i!==void 0?i:o.logLevel,this.minIdLength=e.minIdLength,this.plan=e.plan,this.ingestionMetadata=e.ingestionMetadata,this.offline=e.offline!==void 0?e.offline:o.offline,this.optOut=(r=e.optOut)!==null&&r!==void 0?r:o.optOut,this.serverUrl=e.serverUrl,this.serverZone=e.serverZone||o.serverZone,this.storageProvider=e.storageProvider,this.transportProvider=e.transportProvider,this.useBatch=(s=e.useBatch)!==null&&s!==void 0?s:o.useBatch,this.loggerProvider.enable(this.logLevel);var c=ft(e.serverUrl,e.serverZone,e.useBatch);this.serverZone=c.serverZone,this.serverUrl=c.serverUrl}return Object.defineProperty(n.prototype,"optOut",{get:function(){return this._optOut},set:function(e){this._optOut=e},enumerable:!1,configurable:!0}),n}(),ft=function(n,e,t){if(n===void 0&&(n=""),e===void 0&&(e=Ie().serverZone),t===void 0&&(t=Ie().useBatch),n)return{serverUrl:n,serverZone:void 0};var i,r=["US","EU"].includes(e)?e:Ie().serverZone;return{serverZone:r,serverUrl:(i=t,r==="EU"?i?"https://api.eu.amplitude.com/batch":"https://api.eu.amplitude.com/2/httpapi":i?"https://api2.amplitude.com/batch":lt)}};function we(n){var e="";try{"body"in n&&(e=JSON.stringify(n.body,null,2))}catch{}return e}var Jt=function(){function n(){this.name="amplitude",this.type="destination",this.retryTimeout=1e3,this.throttleTimeout=3e4,this.storageKey="",this.scheduled=null,this.queue=[]}return n.prototype.setup=function(e){var t;return p(this,void 0,void 0,function(){var i,r=this;return v(this,function(s){switch(s.label){case 0:return this.config=e,this.storageKey="".concat(Kt,"_").concat(this.config.apiKey.substring(0,10)),[4,(t=this.config.storageProvider)===null||t===void 0?void 0:t.get(this.storageKey)];case 1:return i=s.sent(),this.saveEvents(),i&&i.length>0&&Promise.all(i.map(function(o){return r.execute(o)})).catch(),[2,Promise.resolve(void 0)]}})})},n.prototype.execute=function(e){var t=this;return new Promise(function(i){t.addToQueue({event:e,attempts:0,callback:function(r){return i(r)},timeout:0})})},n.prototype.addToQueue=function(){for(var e=this,t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];t.filter(function(r){return r.attempts<e.config.flushMaxRetries?(r.attempts+=1,!0):(e.fulfillRequest([r],500,"Event rejected due to exceeded retry count"),!1)}).forEach(function(r){if(e.queue=e.queue.concat(r),r.timeout===0){e.schedule(e.config.flushIntervalMillis);return}setTimeout(function(){r.timeout=0,e.schedule(0)},r.timeout)}),this.saveEvents()},n.prototype.schedule=function(e){var t=this;this.scheduled||this.config.offline||(this.scheduled=setTimeout(function(){t.flush(!0).then(function(){t.queue.length>0&&t.schedule(e)})},e))},n.prototype.flush=function(e){return e===void 0&&(e=!1),p(this,void 0,void 0,function(){var t,i,r=this;return v(this,function(s){switch(s.label){case 0:return this.config.offline?(this.config.loggerProvider.debug("Skipping flush while offline."),[2]):(t=[],i=[],this.queue.forEach(function(o){return o.timeout===0?t.push(o):i.push(o)}),this.queue=i,this.scheduled&&(clearTimeout(this.scheduled),this.scheduled=null),[4,Promise.all(Bt(t,this.config.flushQueueSize).map(function(o){return r.send(o,e)}))]);case 1:return s.sent(),[2]}})})},n.prototype.send=function(e,t){return t===void 0&&(t=!0),p(this,void 0,void 0,function(){var i,r,s,o;return v(this,function(c){switch(c.label){case 0:if(!this.config.apiKey)return[2,this.fulfillRequest(e,400,"Event rejected due to missing API key")];i={api_key:this.config.apiKey,events:e.map(function(d){var u=d.event;return u.extra,Pe(u,["extra"])}),options:{min_id_length:this.config.minIdLength},client_upload_time:new Date().toISOString()},c.label=1;case 1:return c.trys.push([1,3,,4]),r=ft(this.config.serverUrl,this.config.serverZone,this.config.useBatch).serverUrl,[4,this.config.transportProvider.send(r,i)];case 2:return(s=c.sent())===null?(this.fulfillRequest(e,0,"Unexpected error occurred"),[2]):t?(this.handleResponse(s,e),[3,4]):("body"in s?this.fulfillRequest(e,s.statusCode,"".concat(s.status,": ").concat(we(s))):this.fulfillRequest(e,s.statusCode,s.status),[2]);case 3:var l;return o=(l=c.sent())instanceof Error?l.message:String(l),this.config.loggerProvider.error(o),this.fulfillRequest(e,0,o),[3,4];case 4:return[2]}})})},n.prototype.handleResponse=function(e,t){var i=e.status;switch(i){case R.Success:this.handleSuccessResponse(e,t);break;case R.Invalid:this.handleInvalidResponse(e,t);break;case R.PayloadTooLarge:this.handlePayloadTooLargeResponse(e,t);break;case R.RateLimit:this.handleRateLimitResponse(e,t);break;default:this.config.loggerProvider.warn(`{code: 0, error: "Status '`.concat(i,"' provided for ").concat(t.length,' events"}')),this.handleOtherResponse(t)}},n.prototype.handleSuccessResponse=function(e,t){this.fulfillRequest(t,e.statusCode,"Event tracked successfully")},n.prototype.handleInvalidResponse=function(e,t){var i=this;if(e.body.missingField||e.body.error.startsWith("Invalid API key")){this.fulfillRequest(t,e.statusCode,e.body.error);return}var r=$($($($([],U(Object.values(e.body.eventsWithInvalidFields)),!1),U(Object.values(e.body.eventsWithMissingFields)),!1),U(Object.values(e.body.eventsWithInvalidIdLengths)),!1),U(e.body.silencedEvents),!1).flat(),s=new Set(r),o=t.filter(function(c,l){if(s.has(l)){i.fulfillRequest([c],e.statusCode,e.body.error);return}return!0});o.length>0&&this.config.loggerProvider.warn(we(e)),this.addToQueue.apply(this,$([],U(o),!1))},n.prototype.handlePayloadTooLargeResponse=function(e,t){if(t.length===1){this.fulfillRequest(t,e.statusCode,e.body.error);return}this.config.loggerProvider.warn(we(e)),this.config.flushQueueSize/=2,this.addToQueue.apply(this,$([],U(t),!1))},n.prototype.handleRateLimitResponse=function(e,t){var i=this,r=Object.keys(e.body.exceededDailyQuotaUsers),s=Object.keys(e.body.exceededDailyQuotaDevices),o=e.body.throttledEvents,c=new Set(r),l=new Set(s),d=new Set(o),u=t.filter(function(a,g){if(a.event.user_id&&c.has(a.event.user_id)||a.event.device_id&&l.has(a.event.device_id)){i.fulfillRequest([a],e.statusCode,e.body.error);return}return d.has(g)&&(a.timeout=i.throttleTimeout),!0});u.length>0&&this.config.loggerProvider.warn(we(e)),this.addToQueue.apply(this,$([],U(u),!1))},n.prototype.handleOtherResponse=function(e){var t=this;this.addToQueue.apply(this,$([],U(e.map(function(i){return i.timeout=i.attempts*t.retryTimeout,i})),!1))},n.prototype.fulfillRequest=function(e,t,i){this.saveEvents(),e.forEach(function(r){return r.callback(oe(r.event,t,i))})},n.prototype.saveEvents=function(){if(this.config.storageProvider){var e=Array.from(this.queue.map(function(t){return t.event}));this.config.storageProvider.set(this.storageKey,e)}},n}(),pe=function(n){return n?(n^16*Math.random()>>n/4).toString(16):(String(1e7)+String(-1e3)+String(-4e3)+String(-8e3)+String(-1e11)).replace(/[018]/g,pe)};(Q=N||(N={})).SET="$set",Q.SET_ONCE="$setOnce",Q.ADD="$add",Q.APPEND="$append",Q.PREPEND="$prepend",Q.REMOVE="$remove",Q.PREINSERT="$preInsert",Q.POSTINSERT="$postInsert",Q.UNSET="$unset",Q.CLEAR_ALL="$clearAll",(fe=W||(W={})).REVENUE_PRODUCT_ID="$productId",fe.REVENUE_QUANTITY="$quantity",fe.REVENUE_PRICE="$price",fe.REVENUE_TYPE="$revenueType",fe.REVENUE="$revenue",(Oe=ie||(ie={})).IDENTIFY="$identify",Oe.GROUP_IDENTIFY="$groupidentify",Oe.REVENUE="revenue_amount";var Re=function(n){if(Object.keys(n).length>1e3)return!1;for(var e in n){var t=n[e];if(!pt(e,t))return!1}return!0},pt=function(n,e){var t,i;if(typeof n!="string")return!1;if(Array.isArray(e)){var r=!0;try{for(var s=re(e),o=s.next();!o.done;o=s.next()){var c=o.value;if(Array.isArray(c))return!1;if(typeof c=="object")r=r&&Re(c);else if(!["number","string"].includes(typeof c))return!1;if(!r)return!1}}catch(l){t={error:l}}finally{try{o&&!o.done&&(i=s.return)&&i.call(s)}finally{if(t)throw t.error}}}else{if(e==null)return!1;if(typeof e=="object")return Re(e);if(!["number","string","boolean"].includes(typeof e))return!1}return!0},Se=function(){function n(){this._propertySet=new Set,this._properties={}}return n.prototype.getUserProperties=function(){return h({},this._properties)},n.prototype.set=function(e,t){return this._safeSet(N.SET,e,t),this},n.prototype.setOnce=function(e,t){return this._safeSet(N.SET_ONCE,e,t),this},n.prototype.append=function(e,t){return this._safeSet(N.APPEND,e,t),this},n.prototype.prepend=function(e,t){return this._safeSet(N.PREPEND,e,t),this},n.prototype.postInsert=function(e,t){return this._safeSet(N.POSTINSERT,e,t),this},n.prototype.preInsert=function(e,t){return this._safeSet(N.PREINSERT,e,t),this},n.prototype.remove=function(e,t){return this._safeSet(N.REMOVE,e,t),this},n.prototype.add=function(e,t){return this._safeSet(N.ADD,e,t),this},n.prototype.unset=function(e){return this._safeSet(N.UNSET,e,"-"),this},n.prototype.clearAll=function(){return this._properties={},this._properties[N.CLEAR_ALL]="-",this},n.prototype._safeSet=function(e,t,i){if(this._validate(e,t,i)){var r=this._properties[e];return r===void 0&&(r={},this._properties[e]=r),r[t]=i,this._propertySet.add(t),!0}return!1},n.prototype._validate=function(e,t,i){return!(this._properties[N.CLEAR_ALL]!==void 0||this._propertySet.has(t))&&(e===N.ADD?typeof i=="number":e===N.UNSET||e===N.REMOVE||pt(t,i))},n}(),Yt=function(){function n(){this.productId="",this.quantity=1,this.price=0}return n.prototype.setProductId=function(e){return this.productId=e,this},n.prototype.setQuantity=function(e){return e>0&&(this.quantity=e),this},n.prototype.setPrice=function(e){return this.price=e,this},n.prototype.setRevenueType=function(e){return this.revenueType=e,this},n.prototype.setRevenue=function(e){return this.revenue=e,this},n.prototype.setEventProperties=function(e){return Re(e)&&(this.properties=e),this},n.prototype.getEventProperties=function(){var e=this.properties?h({},this.properties):{};return e[W.REVENUE_PRODUCT_ID]=this.productId,e[W.REVENUE_QUANTITY]=this.quantity,e[W.REVENUE_PRICE]=this.price,e[W.REVENUE_TYPE]=this.revenueType,e[W.REVENUE]=this.revenue,e},n}(),Zt=function(){function n(e){this.client=e,this.queue=[],this.applying=!1,this.plugins=[]}return n.prototype.register=function(e,t){var i,r,s;return p(this,void 0,void 0,function(){return v(this,function(o){switch(o.label){case 0:return e.name=(i=e.name)!==null&&i!==void 0?i:pe(),e.type=(r=e.type)!==null&&r!==void 0?r:"enrichment",[4,(s=e.setup)===null||s===void 0?void 0:s.call(e,t,this.client)];case 1:return o.sent(),this.plugins.push(e),[2]}})})},n.prototype.deregister=function(e){var t;return p(this,void 0,void 0,function(){var i,r;return v(this,function(s){switch(s.label){case 0:return i=this.plugins.findIndex(function(o){return o.name===e}),r=this.plugins[i],this.plugins.splice(i,1),[4,(t=r.teardown)===null||t===void 0?void 0:t.call(r)];case 1:return s.sent(),[2]}})})},n.prototype.reset=function(e){this.applying=!1,this.plugins.map(function(t){var i;return(i=t.teardown)===null||i===void 0?void 0:i.call(t)}),this.plugins=[],this.client=e},n.prototype.push=function(e){var t=this;return new Promise(function(i){t.queue.push([e,i]),t.scheduleApply(0)})},n.prototype.scheduleApply=function(e){var t=this;this.applying||(this.applying=!0,setTimeout(function(){t.apply(t.queue.shift()).then(function(){t.applying=!1,t.queue.length>0&&t.scheduleApply(0)})},e))},n.prototype.apply=function(e){return p(this,void 0,void 0,function(){var t,i,r,s,o,c,l,d,u,a,g,y,_,P;return v(this,function(b){switch(b.label){case 0:if(!e)return[2];t=U(e,1)[0],i=U(e,2)[1],r=this.plugins.filter(function(w){return w.type==="before"}),b.label=1;case 1:b.trys.push([1,6,7,8]),o=(s=re(r)).next(),b.label=2;case 2:return o.done?[3,5]:(c=o.value).execute?[4,c.execute(h({},t))]:[3,4];case 3:if((l=b.sent())===null)return i({event:t,code:0,message:""}),[2];t=l,b.label=4;case 4:return o=s.next(),[3,2];case 5:return[3,8];case 6:return g={error:b.sent()},[3,8];case 7:try{o&&!o.done&&(y=s.return)&&y.call(s)}finally{if(g)throw g.error}return[7];case 8:d=this.plugins.filter(function(w){return w.type==="enrichment"||w.type===void 0}),b.label=9;case 9:b.trys.push([9,14,15,16]),a=(u=re(d)).next(),b.label=10;case 10:return a.done?[3,13]:(c=a.value).execute?[4,c.execute(h({},t))]:[3,12];case 11:if((l=b.sent())===null)return i({event:t,code:0,message:""}),[2];t=l,b.label=12;case 12:return a=u.next(),[3,10];case 13:return[3,16];case 14:return _={error:b.sent()},[3,16];case 15:try{a&&!a.done&&(P=u.return)&&P.call(u)}finally{if(_)throw _.error}return[7];case 16:return Promise.all(this.plugins.filter(function(w){return w.type==="destination"}).map(function(w){var x=h({},t);return w.execute(x).catch(function(S){return oe(x,0,String(S))})})).then(function(w){i(U(w,1)[0]||oe(t,100,"Event not tracked, no destination plugins on the instance"))}),[2]}})})},n.prototype.flush=function(){return p(this,void 0,void 0,function(){var e,t=this;return v(this,function(i){switch(i.label){case 0:return e=this.queue,this.queue=[],[4,Promise.all(e.map(function(r){return t.apply(r)}))];case 1:return i.sent(),[4,Promise.all(this.plugins.filter(function(r){return r.type==="destination"}).map(function(r){return r.flush&&r.flush()}))];case 2:return i.sent(),[2]}})})},n}(),vt=function(n,e){return h(h({},e),{event_type:ie.IDENTIFY,user_properties:n.getUserProperties()})},Wt=function(n,e,t,i){var r;return h(h({},i),{event_type:ie.GROUP_IDENTIFY,group_properties:t.getUserProperties(),groups:((r={})[n]=e,r)})},Gt=function(n,e,t){var i,r=new Se;return r.set(n,e),h(h({},t),{event_type:ie.IDENTIFY,user_properties:r.getUserProperties(),groups:((i={})[n]=e,i)})},Ht=function(){function n(e){e===void 0&&(e="$default"),this.initializing=!1,this.q=[],this.dispatchQ=[],this.logEvent=this.track.bind(this),this.timeline=new Zt(this),this.name=e}return n.prototype._init=function(e){return p(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.config=e,this.timeline.reset(this),[4,this.runQueuedFunctions("q")];case 1:return t.sent(),[2]}})})},n.prototype.runQueuedFunctions=function(e){return p(this,void 0,void 0,function(){var t,i,r,s,o;return v(this,function(c){switch(c.label){case 0:t=this[e],this[e]=[],c.label=1;case 1:c.trys.push([1,6,7,8]),r=(i=re(t)).next(),c.label=2;case 2:return r.done?[3,5]:[4,(0,r.value)()];case 3:c.sent(),c.label=4;case 4:return r=i.next(),[3,2];case 5:return[3,8];case 6:return s={error:c.sent()},[3,8];case 7:try{r&&!r.done&&(o=i.return)&&o.call(i)}finally{if(s)throw s.error}return[7];case 8:return[2]}})})},n.prototype.track=function(e,t,i){var r=h(h(h({},typeof e=="string"?{event_type:e}:e),i),t&&{event_properties:t});return L(this.dispatch(r))},n.prototype.identify=function(e,t){var i=vt(e,t);return L(this.dispatch(i))},n.prototype.groupIdentify=function(e,t,i,r){var s=Wt(e,t,i,r);return L(this.dispatch(s))},n.prototype.setGroup=function(e,t,i){var r=Gt(e,t,i);return L(this.dispatch(r))},n.prototype.revenue=function(e,t){var i=h(h({},t),{event_type:ie.REVENUE,event_properties:e.getEventProperties()});return L(this.dispatch(i))},n.prototype.add=function(e){return this.config?L(this.timeline.register(e,this.config)):(this.q.push(this.add.bind(this,e)),L())},n.prototype.remove=function(e){return this.config?L(this.timeline.deregister(e)):(this.q.push(this.remove.bind(this,e)),L())},n.prototype.dispatchWithCallback=function(e,t){if(!this.config)return t(oe(e,0,"Client not initialized"));this.process(e).then(t)},n.prototype.dispatch=function(e){return p(this,void 0,void 0,function(){var t=this;return v(this,function(i){return this.config?[2,this.process(e)]:[2,new Promise(function(r){t.dispatchQ.push(t.dispatchWithCallback.bind(t,e,r))})]})})},n.prototype.process=function(e){return p(this,void 0,void 0,function(){var t,i;return v(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),this.config.optOut?[2,oe(e,0,"Event skipped due to optOut config")]:[4,this.timeline.push(e)];case 1:return(t=r.sent()).code===200?this.config.loggerProvider.log(t.message):t.code===100?this.config.loggerProvider.warn(t.message):this.config.loggerProvider.error(t.message),[2,t];case 2:return i=String(r.sent()),this.config.loggerProvider.error(i),[2,t=oe(e,0,i)];case 3:return[2]}})})},n.prototype.setOptOut=function(e){if(!this.config){this.q.push(this.setOptOut.bind(this,!!e));return}this.config.optOut=!!e},n.prototype.flush=function(){return L(this.timeline.flush())},n}(),Xt=function(){function n(){}return n.prototype.getApplicationContext=function(){return{versionName:this.versionName,language:en(),platform:"Web",os:void 0,deviceModel:void 0}},n}(),en=function(){return typeof navigator<"u"&&(navigator.languages&&navigator.languages[0]||navigator.language)||""},tn=function(){function n(){this.queue=[]}return n.prototype.logEvent=function(e){this.receiver?this.receiver(e):this.queue.length<512&&this.queue.push(e)},n.prototype.setEventReceiver=function(e){this.receiver=e,this.queue.length>0&&(this.queue.forEach(function(t){e(t)}),this.queue=[])},n}(),H=function(){return(H=Object.assign||function(n){for(var e,t=1,i=arguments.length;t<i;t++)for(var r in e=arguments[t])Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}).apply(this,arguments)},Ee=function(n,e){var t=typeof n;if(t!==typeof e)return!1;for(var i=0,r=["string","number","boolean","undefined"];i<r.length;i++)if(r[i]===t)return n===e;if(n==null&&e==null)return!0;if(n==null||e==null||n.length!==e.length)return!1;var s=Array.isArray(n),o=Array.isArray(e);if(s!==o)return!1;if(s&&o){for(var c=0;c<n.length;c++)if(!Ee(n[c],e[c]))return!1}else{if(!Ee(Object.keys(n).sort(),Object.keys(e).sort()))return!1;var l=!0;return Object.keys(n).forEach(function(d){Ee(n[d],e[d])||(l=!1)}),l}return!0};Object.entries||(Object.entries=function(n){for(var e=Object.keys(n),t=e.length,i=Array(t);t--;)i[t]=[e[t],n[e[t]]];return i});var nn=function(){function n(){this.identity={userProperties:{}},this.listeners=new Set}return n.prototype.editIdentity=function(){var e=this,t=H({},this.identity.userProperties),i=H(H({},this.identity),{userProperties:t});return{setUserId:function(r){return i.userId=r,this},setDeviceId:function(r){return i.deviceId=r,this},setUserProperties:function(r){return i.userProperties=r,this},setOptOut:function(r){return i.optOut=r,this},updateUserProperties:function(r){for(var s=i.userProperties||{},o=0,c=Object.entries(r);o<c.length;o++){var l=c[o],d=l[0],u=l[1];switch(d){case"$set":for(var a=0,g=Object.entries(u);a<g.length;a++){var y=g[a],_=y[0],P=y[1];s[_]=P}break;case"$unset":for(var b=0,w=Object.keys(u);b<w.length;b++){var _=w[b];delete s[_]}break;case"$clearAll":s={}}}return i.userProperties=s,this},commit:function(){return e.setIdentity(i),this}}},n.prototype.getIdentity=function(){return H({},this.identity)},n.prototype.setIdentity=function(e){var t=H({},this.identity);this.identity=H({},e),Ee(t,this.identity)||this.listeners.forEach(function(i){i(e)})},n.prototype.addIdentityListener=function(e){this.listeners.add(e)},n.prototype.removeIdentityListener=function(e){this.listeners.delete(e)},n}(),ve=typeof globalThis<"u"?globalThis:de.g!==void 0?de.g:self,rn=function(){function n(){this.identityStore=new nn,this.eventBridge=new tn,this.applicationContextProvider=new Xt}return n.getInstance=function(e){return ve.analyticsConnectorInstances||(ve.analyticsConnectorInstances={}),ve.analyticsConnectorInstances[e]||(ve.analyticsConnectorInstances[e]=new n),ve.analyticsConnectorInstances[e]},n}(),he=function(n){return n===void 0&&(n="$default_instance"),rn.getInstance(n)},on=function(n,e){he(e).identityStore.editIdentity().setUserId(n).commit()},sn=function(n,e){he(e).identityStore.editIdentity().setDeviceId(n).commit()},un=function(){function n(){this.name="identity",this.type="before",this.identityStore=he().identityStore}return n.prototype.execute=function(e){return p(this,void 0,void 0,function(){var t;return v(this,function(i){return(t=e.user_properties)&&this.identityStore.editIdentity().updateUserProperties(t).commit(),[2,e]})})},n.prototype.setup=function(e){return p(this,void 0,void 0,function(){return v(this,function(t){return e.instanceName&&(this.identityStore=he(e.instanceName).identityStore),[2]})})},n}(),ge=function(n,e){return typeof n=="boolean"?n:n?.[e]!==!1},ht=function(n){return ge(n,"attribution")},gt=function(n){return ge(n,"pageViews")},an=function(n){var e,t=function(){return!1},i=void 0;return gt(n.defaultTracking)&&(t=void 0,e=void 0,n.defaultTracking&&typeof n.defaultTracking=="object"&&n.defaultTracking.pageViews&&typeof n.defaultTracking.pageViews=="object"&&("trackOn"in n.defaultTracking.pageViews&&(t=n.defaultTracking.pageViews.trackOn),"trackHistoryChanges"in n.defaultTracking.pageViews&&(i=n.defaultTracking.pageViews.trackHistoryChanges),"eventType"in n.defaultTracking.pageViews&&n.defaultTracking.pageViews.eventType&&(e=n.defaultTracking.pageViews.eventType))),{trackOn:t,trackHistoryChanges:i,eventType:e}},yt=function(n,e){return e===void 0&&(e=Date.now()),Date.now()-e>n},xe=function(n,e){for(var t=0;t<e.length;t++){var i=e[t],r=i.name,s=i.args,o=i.resolve,c=n&&n[r];if(typeof c=="function"){var l=c.apply(n,s);typeof o=="function"&&o(l?.promise)}}return n},Ne=function(n){return n&&n._q!==void 0},cn=function(){if(typeof navigator>"u")return"";var n,e,t,i,r=navigator.userLanguage;return(i=(t=(e=(n=navigator.languages)===null||n===void 0?void 0:n[0])!==null&&e!==void 0?e:navigator.language)!==null&&t!==void 0?t:r)!==null&&i!==void 0?i:""},ln=function(){function n(){this.name="@amplitude/plugin-context-browser",this.type="before",this.library="amplitude-ts/".concat("2.4.1"),typeof navigator<"u"&&(this.userAgent=navigator.userAgent)}return n.prototype.setup=function(e){return this.config=e,Promise.resolve(void 0)},n.prototype.execute=function(e){var t,i;return p(this,void 0,void 0,function(){var r,s,o;return v(this,function(c){return r=new Date().getTime(),s=(t=this.config.lastEventId)!==null&&t!==void 0?t:-1,o=(i=e.event_id)!==null&&i!==void 0?i:s+1,this.config.lastEventId=o,e.time||(this.config.lastEventTime=r),[2,h(h(h(h(h(h(h(h({user_id:this.config.userId,device_id:this.config.deviceId,session_id:this.config.sessionId,time:r},this.config.appVersion&&{app_version:this.config.appVersion}),this.config.trackingOptions.platform&&{platform:"Web"}),this.config.trackingOptions.language&&{language:cn()}),this.config.trackingOptions.ipAddress&&{ip:"$remote"}),{insert_id:pe(),partner_id:this.config.partnerId,plan:this.config.plan}),this.config.ingestionMetadata&&{ingestion_metadata:{source_name:this.config.ingestionMetadata.sourceName,source_version:this.config.ingestionMetadata.sourceVersion}}),e),{event_id:o,library:this.library,user_agent:this.userAgent})]})})},n}(),mt=function(){function n(){this.memoryStorage=new Map}return n.prototype.isEnabled=function(){return p(this,void 0,void 0,function(){return v(this,function(e){return[2,!0]})})},n.prototype.get=function(e){return p(this,void 0,void 0,function(){return v(this,function(t){return[2,this.memoryStorage.get(e)]})})},n.prototype.getRaw=function(e){return p(this,void 0,void 0,function(){var t;return v(this,function(i){switch(i.label){case 0:return[4,this.get(e)];case 1:return[2,(t=i.sent())?JSON.stringify(t):void 0]}})})},n.prototype.set=function(e,t){return p(this,void 0,void 0,function(){return v(this,function(i){return this.memoryStorage.set(e,t),[2]})})},n.prototype.remove=function(e){return p(this,void 0,void 0,function(){return v(this,function(t){return this.memoryStorage.delete(e),[2]})})},n.prototype.reset=function(){return p(this,void 0,void 0,function(){return v(this,function(e){return this.memoryStorage.clear(),[2]})})},n}(),bt=function(n,e,t){return e===void 0&&(e=""),t===void 0&&(t=10),["AMP",e,n.substring(0,t)].filter(Boolean).join("_")},J=function(){return typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof self<"u"?self:de.g!==void 0?de.g:void 0},Ue=function(){var n,e=J();return!((n=e?.location)===null||n===void 0)&&n.search?e.location.search.substring(1).split("&").filter(Boolean).reduce(function(t,i){var r=i.split("=",2),s=_t(r[0]),o=_t(r[1]);return o&&(t[s]=o),t},{}):{}},_t=function(n){n===void 0&&(n="");try{return decodeURIComponent(n)}catch{return""}},De=function(){function n(e){this.options=h({},e)}return n.prototype.isEnabled=function(){return p(this,void 0,void 0,function(){var e,t;return v(this,function(i){switch(i.label){case 0:if(!J())return[2,!1];n.testValue=String(Date.now()),e=new n(this.options),t="AMP_TEST",i.label=1;case 1:return i.trys.push([1,4,5,7]),[4,e.set(t,n.testValue)];case 2:return i.sent(),[4,e.get(t)];case 3:return[2,i.sent()===n.testValue];case 4:return i.sent(),[2,!1];case 5:return[4,e.remove(t)];case 6:return i.sent(),[7];case 7:return[2]}})})},n.prototype.get=function(e){return p(this,void 0,void 0,function(){var t;return v(this,function(i){switch(i.label){case 0:return[4,this.getRaw(e)];case 1:if(!(t=i.sent()))return[2,void 0];try{try{t=decodeURIComponent(atob(t))}catch{}return[2,JSON.parse(t)]}catch{return[2,void 0]}return[2]}})})},n.prototype.getRaw=function(e){var t,i;return p(this,void 0,void 0,function(){var r,s;return v(this,function(o){return(s=((i=(t=(r=J())==null?void 0:r.document)===null||t===void 0?void 0:t.cookie.split("; "))!==null&&i!==void 0?i:[]).find(function(c){return c.indexOf(e+"=")===0}))?[2,s.substring(e.length+1)]:[2,void 0]})})},n.prototype.set=function(e,t){var i;return p(this,void 0,void 0,function(){var r,s,o,c,l,d;return v(this,function(u){try{r=(i=this.options.expirationDays)!==null&&i!==void 0?i:0,s=t!==null?r:-1,o=void 0,s&&((c=new Date).setTime(c.getTime()+864e5*s),o=c),l="".concat(e,"=").concat(btoa(encodeURIComponent(JSON.stringify(t)))),o&&(l+="; expires=".concat(o.toUTCString())),l+="; path=/",this.options.domain&&(l+="; domain=".concat(this.options.domain)),this.options.secure&&(l+="; Secure"),this.options.sameSite&&(l+="; SameSite=".concat(this.options.sameSite)),(d=J())&&(d.document.cookie=l)}catch{}return[2]})})},n.prototype.remove=function(e){return p(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,this.set(e,null)];case 1:return t.sent(),[2]}})})},n.prototype.reset=function(){return p(this,void 0,void 0,function(){return v(this,function(e){return[2]})})},n}(),qe=function(){function n(){}return n.prototype.send=function(e,t){return Promise.resolve(null)},n.prototype.buildResponse=function(e){if(typeof e!="object")return null;var t,i,r,s,o,c,l,d,u,a,g,y,_,P,b,w,x,S,I,K,Z,B,D=e.code||0,C=this.buildStatus(D);switch(C){case R.Success:return{status:C,statusCode:D,body:{eventsIngested:(t=e.events_ingested)!==null&&t!==void 0?t:0,payloadSizeBytes:(i=e.payload_size_bytes)!==null&&i!==void 0?i:0,serverUploadTime:(r=e.server_upload_time)!==null&&r!==void 0?r:0}};case R.Invalid:return{status:C,statusCode:D,body:{error:(s=e.error)!==null&&s!==void 0?s:"",missingField:(o=e.missing_field)!==null&&o!==void 0?o:"",eventsWithInvalidFields:(c=e.events_with_invalid_fields)!==null&&c!==void 0?c:{},eventsWithMissingFields:(l=e.events_with_missing_fields)!==null&&l!==void 0?l:{},eventsWithInvalidIdLengths:(d=e.events_with_invalid_id_lengths)!==null&&d!==void 0?d:{},epsThreshold:(u=e.eps_threshold)!==null&&u!==void 0?u:0,exceededDailyQuotaDevices:(a=e.exceeded_daily_quota_devices)!==null&&a!==void 0?a:{},silencedDevices:(g=e.silenced_devices)!==null&&g!==void 0?g:[],silencedEvents:(y=e.silenced_events)!==null&&y!==void 0?y:[],throttledDevices:(_=e.throttled_devices)!==null&&_!==void 0?_:{},throttledEvents:(P=e.throttled_events)!==null&&P!==void 0?P:[]}};case R.PayloadTooLarge:return{status:C,statusCode:D,body:{error:(b=e.error)!==null&&b!==void 0?b:""}};case R.RateLimit:return{status:C,statusCode:D,body:{error:(w=e.error)!==null&&w!==void 0?w:"",epsThreshold:(x=e.eps_threshold)!==null&&x!==void 0?x:0,throttledDevices:(S=e.throttled_devices)!==null&&S!==void 0?S:{},throttledUsers:(I=e.throttled_users)!==null&&I!==void 0?I:{},exceededDailyQuotaDevices:(K=e.exceeded_daily_quota_devices)!==null&&K!==void 0?K:{},exceededDailyQuotaUsers:(Z=e.exceeded_daily_quota_users)!==null&&Z!==void 0?Z:{},throttledEvents:(B=e.throttled_events)!==null&&B!==void 0?B:[]}};case R.Timeout:default:return{status:C,statusCode:D}}},n.prototype.buildStatus=function(e){return e>=200&&e<300?R.Success:e===429?R.RateLimit:e===413?R.PayloadTooLarge:e===408?R.Timeout:e>=400&&e<500?R.Invalid:e>=500?R.Failed:R.Unknown},n}(),dn=function(n){function e(){return n!==null&&n.apply(this,arguments)||this}return G(e,n),e.prototype.send=function(t,i){return p(this,void 0,void 0,function(){var r,s;return v(this,function(o){switch(o.label){case 0:if(typeof fetch>"u")throw Error("FetchTransport is not supported");return r={headers:{"Content-Type":"application/json",Accept:"*/*"},body:JSON.stringify(i),method:"POST"},[4,fetch(t,r)];case 1:return[4,o.sent().json()];case 2:return s=o.sent(),[2,this.buildResponse(s)]}})})},e}(qe),It=function(){function n(e){this.storage=e}return n.prototype.isEnabled=function(){return p(this,void 0,void 0,function(){var e,t,i;return v(this,function(r){switch(r.label){case 0:if(!this.storage)return[2,!1];e=String(Date.now()),t=new n(this.storage),i="AMP_TEST",r.label=1;case 1:return r.trys.push([1,4,5,7]),[4,t.set(i,e)];case 2:return r.sent(),[4,t.get(i)];case 3:return[2,r.sent()===e];case 4:return r.sent(),[2,!1];case 5:return[4,t.remove(i)];case 6:return r.sent(),[7];case 7:return[2]}})})},n.prototype.get=function(e){return p(this,void 0,void 0,function(){var t;return v(this,function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,this.getRaw(e)];case 1:return(t=i.sent())?[2,JSON.parse(t)]:[2,void 0];case 2:return i.sent(),console.error("[Amplitude] Error: Could not get value from storage"),[2,void 0];case 3:return[2]}})})},n.prototype.getRaw=function(e){var t;return p(this,void 0,void 0,function(){return v(this,function(i){return[2,((t=this.storage)===null||t===void 0?void 0:t.getItem(e))||void 0]})})},n.prototype.set=function(e,t){var i;return p(this,void 0,void 0,function(){return v(this,function(r){try{(i=this.storage)===null||i===void 0||i.setItem(e,JSON.stringify(t))}catch{}return[2]})})},n.prototype.remove=function(e){var t;return p(this,void 0,void 0,function(){return v(this,function(i){try{(t=this.storage)===null||t===void 0||t.removeItem(e)}catch{}return[2]})})},n.prototype.reset=function(){var e;return p(this,void 0,void 0,function(){return v(this,function(t){try{(e=this.storage)===null||e===void 0||e.clear()}catch{}return[2]})})},n}(),wt=function(n){function e(t){var i,r=this;return(r=n.call(this,(i=J())===null||i===void 0?void 0:i.localStorage)||this).loggerProvider=t?.loggerProvider,r}return G(e,n),e.prototype.set=function(t,i){var r;return p(this,void 0,void 0,function(){var s;return v(this,function(o){switch(o.label){case 0:return Array.isArray(i)&&i.length>1e3?(s=i.length-1e3,[4,n.prototype.set.call(this,t,i.slice(0,1e3))]):[3,2];case 1:return o.sent(),(r=this.loggerProvider)===null||r===void 0||r.error("Failed to save ".concat(s," events because the queue length exceeded ").concat(1e3,".")),[3,4];case 2:return[4,n.prototype.set.call(this,t,i)];case 3:o.sent(),o.label=4;case 4:return[2]}})})},e}(It),fn=function(n){function e(){var t;return n.call(this,(t=J())===null||t===void 0?void 0:t.sessionStorage)||this}return G(e,n),e}(It),pn=function(n){function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.state={done:4},t}return G(e,n),e.prototype.send=function(t,i){return p(this,void 0,void 0,function(){var r=this;return v(this,function(s){return[2,new Promise(function(o,c){typeof XMLHttpRequest>"u"&&c(Error("XHRTransport is not supported."));var l=new XMLHttpRequest;l.open("POST",t,!0),l.onreadystatechange=function(){if(l.readyState===r.state.done)try{var d=l.responseText,u=JSON.parse(d),a=r.buildResponse(u);o(a)}catch(g){c(g)}},l.setRequestHeader("Content-Type","application/json"),l.setRequestHeader("Accept","*/*"),l.send(JSON.stringify(i))})]})})},e}(qe),vn=function(n){function e(){return n!==null&&n.apply(this,arguments)||this}return G(e,n),e.prototype.send=function(t,i){return p(this,void 0,void 0,function(){var r=this;return v(this,function(s){return[2,new Promise(function(o,c){var l=J();if(!l?.navigator.sendBeacon)throw Error("SendBeaconTransport is not supported");try{var d=JSON.stringify(i);return l.navigator.sendBeacon(t,JSON.stringify(i))?o(r.buildResponse({code:200,events_ingested:i.events.length,payload_size_bytes:d.length,server_upload_time:Date.now()})):o(r.buildResponse({code:500}))}catch(u){c(u)}})]})})},e}(qe),Ae=function(n){var e=parseInt(n,32);if(!isNaN(e))return e},hn=function(n){if(atob&&escape&&n)try{return decodeURIComponent(escape(atob(n)))}catch{return}},j="[Amplitude]",St="".concat(j," Form Started"),gn="".concat(j," Form Submitted"),yn="".concat(j," File Downloaded"),Et="session_start",Tt="session_end",mn="".concat(j," File Extension"),bn="".concat(j," File Name"),_n="".concat(j," Link ID"),In="".concat(j," Link Text"),wn="".concat(j," Link URL"),Le="".concat(j," Form ID"),je="".concat(j," Form Name"),Ce="".concat(j," Form Destination"),Te="cookie",Sn=function(n){function e(t,i,r,s,o,c,l,d,u,a,g,y,_,P,b,w,x,S,I,K,Z,B,D,C,ue,X,ae,A,ee,ye){r===void 0&&(r=new mt),s===void 0&&(s={domain:"",expiration:365,sameSite:"Lax",secure:!1,upgrade:!0}),l===void 0&&(l=1e3),d===void 0&&(d=5),u===void 0&&(u=30),a===void 0&&(a=Te),b===void 0&&(b=new dt),w===void 0&&(w=q.Warn),S===void 0&&(S=!1),I===void 0&&(I=!1),B===void 0&&(B=""),D===void 0&&(D="US"),ue===void 0&&(ue=18e5),X===void 0&&(X=new wt({loggerProvider:b})),ae===void 0&&(ae={ipAddress:!0,language:!0,platform:!0}),A===void 0&&(A="fetch"),ee===void 0&&(ee=!1);var m=n.call(this,{apiKey:t,storageProvider:X,transportProvider:kt(A)})||this;return m.apiKey=t,m.appVersion=i,m.cookieOptions=s,m.defaultTracking=o,m.flushIntervalMillis=l,m.flushMaxRetries=d,m.flushQueueSize=u,m.identityStorage=a,m.ingestionMetadata=g,m.instanceName=y,m.loggerProvider=b,m.logLevel=w,m.minIdLength=x,m.offline=S,m.partnerId=K,m.plan=Z,m.serverUrl=B,m.serverZone=D,m.sessionTimeout=ue,m.storageProvider=X,m.trackingOptions=ae,m.transport=A,m.useBatch=ee,m._optOut=!1,m._cookieStorage=r,m.deviceId=c,m.lastEventId=_,m.lastEventTime=P,m.optOut=I,m.sessionId=C,m.userId=ye,m.loggerProvider.enable(m.logLevel),m}return G(e,n),Object.defineProperty(e.prototype,"cookieStorage",{get:function(){return this._cookieStorage},set:function(t){this._cookieStorage!==t&&(this._cookieStorage=t,this.updateStorage())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"deviceId",{get:function(){return this._deviceId},set:function(t){this._deviceId!==t&&(this._deviceId=t,this.updateStorage())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"userId",{get:function(){return this._userId},set:function(t){this._userId!==t&&(this._userId=t,this.updateStorage())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"sessionId",{get:function(){return this._sessionId},set:function(t){this._sessionId!==t&&(this._sessionId=t,this.updateStorage())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"optOut",{get:function(){return this._optOut},set:function(t){this._optOut!==t&&(this._optOut=t,this.updateStorage())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"lastEventTime",{get:function(){return this._lastEventTime},set:function(t){this._lastEventTime!==t&&(this._lastEventTime=t,this.updateStorage())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"lastEventId",{get:function(){return this._lastEventId},set:function(t){this._lastEventId!==t&&(this._lastEventId=t,this.updateStorage())},enumerable:!1,configurable:!0}),e.prototype.updateStorage=function(){var t={deviceId:this._deviceId,userId:this._userId,sessionId:this._sessionId,optOut:this._optOut,lastEventTime:this._lastEventTime,lastEventId:this._lastEventId};this.cookieStorage.set(bt(this.apiKey),t)},e}(zt),En=function(n,e){switch(n===void 0&&(n=Te),e===void 0&&(e={}),n){case"localStorage":return new wt;case"sessionStorage":return new fn;case"none":return new mt;default:return new De(h(h({},e),{expirationDays:e.expiration}))}},kt=function(n){return n==="xhr"?new pn:n==="beacon"?new vn:new dn},Ot="dclid",Pt="fbclid",Rt="gbraid",xt="gclid",Nt="ko_click_id",Ut="li_fat_id",Dt="msclkid",qt="rtd_cid",At="ttclid",Lt="twclid",jt="wbraid",Me={utm_campaign:void 0,utm_content:void 0,utm_id:void 0,utm_medium:void 0,utm_source:void 0,utm_term:void 0,referrer:void 0,referring_domain:void 0,dclid:void 0,gbraid:void 0,gclid:void 0,fbclid:void 0,ko_click_id:void 0,li_fat_id:void 0,msclkid:void 0,rtd_cid:void 0,ttclid:void 0,twclid:void 0,wbraid:void 0},Ct=function(){function n(){}return n.prototype.parse=function(){return p(this,void 0,void 0,function(){return v(this,function(e){return[2,h(h(h(h({},Me),this.getUtmParam()),this.getReferrer()),this.getClickIds())]})})},n.prototype.getUtmParam=function(){var e=Ue();return{utm_campaign:e.utm_campaign,utm_content:e.utm_content,utm_id:e.utm_id,utm_medium:e.utm_medium,utm_source:e.utm_source,utm_term:e.utm_term}},n.prototype.getReferrer=function(){var e,t,i={referrer:void 0,referring_domain:void 0};try{i.referrer=document.referrer||void 0,i.referring_domain=(t=(e=i.referrer)===null||e===void 0?void 0:e.split("/")[2])!==null&&t!==void 0?t:void 0}catch{}return i},n.prototype.getClickIds=function(){var e,t=Ue();return(e={})[Ot]=t[Ot],e[Pt]=t[Pt],e[Rt]=t[Rt],e[xt]=t[xt],e[Nt]=t[Nt],e[Ut]=t[Ut],e[Dt]=t[Dt],e[qt]=t[qt],e[At]=t[At],e[Lt]=t[Lt],e[jt]=t[jt],e},n}(),Mt=function(n){var e=n.split(".");return e.length<=2?n:e.slice(e.length-2,e.length).join(".")},Tn=function(n,e,t,i){i===void 0&&(i=!0),n.referrer;var r=n.referring_domain,s=Pe(n,["referrer","referring_domain"]),o=e||{},c=(o.referrer,o.referring_domain),l=Pe(o,["referrer","referring_domain"]);if(kn(t.excludeReferrers,n.referring_domain)||!i&&Object.values(n).every(function(a){return!a})&&e)return!1;var d=JSON.stringify(s)!==JSON.stringify(l),u=Mt(r||"")!==Mt(c||"");return!e||d||u},kn=function(n,e){return n===void 0&&(n=[]),e===void 0&&(e=""),n.some(function(t){return t instanceof RegExp?t.test(e):t===e})},On=function(n){var e=n;return e?(e.startsWith(".")&&(e=e.substring(1)),[new RegExp("".concat(e.replace(".","\\."),"$"))]):[]},Pn=function(n){var e=this;return n===void 0&&(n={}),{name:"@amplitude/plugin-web-attribution-browser",type:"before",setup:function(t,i){var r;return p(this,void 0,void 0,function(){var s,o,c,l,d,u;return v(this,function(a){var g,y,_;switch(a.label){case 0:return s=h({initialEmptyValue:"EMPTY",resetSessionOnNewCampaign:!1,excludeReferrers:On((r=t.cookieOptions)===null||r===void 0?void 0:r.domain)},n),t.loggerProvider.log("Installing @amplitude/plugin-web-attribution-browser."),o=t.cookieStorage,g=t.apiKey,y===void 0&&(y=10),c=["AMP","MKTG",g.substring(0,y)].filter(Boolean).join("_"),[4,Promise.all([new Ct().parse(),o.get(c)])];case 1:return Tn(d=(l=U.apply(void 0,[a.sent(),2]))[0],l[1],s,yt(t.sessionTimeout,t.lastEventTime))&&(s.resetSessionOnNewCampaign&&(i.setSessionId(Date.now()),t.loggerProvider.log("Created a new session for new campaign.")),t.loggerProvider.log("Tracking attribution."),_=s,u=vt(Object.entries(h(h({},Me),d)).reduce(function(P,b){var w,x=U(b,2),S=x[0],I=x[1];return P.setOnce("initial_".concat(S),(w=I??_.initialEmptyValue)!==null&&w!==void 0?w:"EMPTY"),I?P.set(S,I):P.unset(S)},new Se)),i.track(u),o.set(c,d)),[2]}})})},execute:function(t){return p(e,void 0,void 0,function(){return v(this,function(i){return[2,t]})})}}},Rn=function(n){var e={};for(var t in n){var i=n[t];i&&(e[t]=i)}return e},xn=function(n){n===void 0&&(n={});var e,t,i=J(),r=void 0,s=function(){return p(void 0,void 0,void 0,function(){var u,a,g;return v(this,function(y){switch(y.label){case 0:return a={event_type:(g=n.eventType)!==null&&g!==void 0?g:"[Amplitude] Page Viewed"},u=[{}],[4,Nn()];case 1:return[2,(a.event_properties=h.apply(void 0,[h.apply(void 0,u.concat([y.sent()])),{"[Amplitude] Page Domain":typeof location<"u"&&location.hostname||"","[Amplitude] Page Location":typeof location<"u"&&location.href||"","[Amplitude] Page Path":typeof location<"u"&&location.pathname||"","[Amplitude] Page Title":typeof document<"u"&&document.title||"","[Amplitude] Page URL":typeof location<"u"&&location.href.split("?")[0]||""}]),a)]}})})},o=function(){return n.trackOn===void 0||typeof n.trackOn=="function"&&n.trackOn()},c=typeof location<"u"?location.href:null,l=function(){return p(void 0,void 0,void 0,function(){var u,a,g,y;return v(this,function(_){switch(_.label){case 0:return u=location.href,a=Dn(n.trackHistoryChanges,u,c||"")&&o(),c=u,a?(r?.log("Tracking page view event"),e!=null?[3,1]:[3,3]):[3,4];case 1:return y=(g=e).track,[4,s()];case 2:y.apply(g,[_.sent()]),_.label=3;case 3:_.label=4;case 4:return[2]}})})},d=function(){l()};return{name:"@amplitude/plugin-page-view-tracking-browser",type:"enrichment",setup:function(u,a){return p(void 0,void 0,void 0,function(){var g,y;return v(this,function(_){switch(_.label){case 0:return e=a,(r=u.loggerProvider).log("Installing @amplitude/plugin-page-view-tracking-browser"),i&&(i.addEventListener("popstate",d),t=i.history.pushState,i.history.pushState=new Proxy(i.history.pushState,{apply:function(P,b,w){var x=U(w,3),S=x[0],I=x[1],K=x[2];P.apply(b,[S,I,K]),l()}})),o()?(r.log("Tracking page view event"),y=(g=e).track,[4,s()]):[3,2];case 1:y.apply(g,[_.sent()]),_.label=2;case 2:return[2]}})})},execute:function(u){return p(void 0,void 0,void 0,function(){var a;return v(this,function(g){switch(g.label){case 0:return n.trackOn==="attribution"&&Un(u)?(r?.log("Enriching campaign event to page view event with campaign parameters"),[4,s()]):[3,2];case 1:a=g.sent(),u.event_type=a.event_type,u.event_properties=h(h({},u.event_properties),a.event_properties),g.label=2;case 2:return[2,u]}})})},teardown:function(){return p(void 0,void 0,void 0,function(){return v(this,function(u){return i&&(i.removeEventListener("popstate",d),t&&(i.history.pushState=t)),[2]})})}}},Nn=function(){return p(void 0,void 0,void 0,function(){var n;return v(this,function(e){switch(e.label){case 0:return n=Rn,[4,new Ct().parse()];case 1:return[2,n.apply(void 0,[e.sent()])]}})})},Un=function(n){if(n.event_type==="$identify"&&n.user_properties){var e=n.user_properties,t=e[N.SET]||{},i=e[N.UNSET]||{},r=$($([],U(Object.keys(t)),!1),U(Object.keys(i)),!1);return Object.keys(Me).every(function(s){return r.includes(s)})}return!1},Dn=function(n,e,t){return n==="pathOnly"?e.split("?")[0]!==t.split("?")[0]:e!==t},qn=function(){var n,e=[],t=function(r,s,o){r.addEventListener(s,o),e.push({element:r,type:s,handler:o})},i=function(){e.forEach(function(r){var s=r.element,o=r.type,c=r.handler;s?.removeEventListener(o,c)}),e=[]};return{name:"@amplitude/plugin-form-interaction-tracking-browser",type:"enrichment",setup:function(r,s){return p(void 0,void 0,void 0,function(){var o;return v(this,function(c){return s?typeof document>"u"||(o=function(l){var d=!1;t(l,"change",function(){var u;d||s.track(St,((u={})[Le]=se(l.id),u[je]=se(l.name),u[Ce]=l.action,u)),d=!0}),t(l,"submit",function(){var u,a;d||s.track(St,((u={})[Le]=se(l.id),u[je]=se(l.name),u[Ce]=l.action,u)),s.track(gn,((a={})[Le]=se(l.id),a[je]=se(l.name),a[Ce]=l.action,a)),d=!1})},Array.from(document.getElementsByTagName("form")).forEach(o),typeof MutationObserver<"u"&&(n=new MutationObserver(function(l){l.forEach(function(d){d.addedNodes.forEach(function(u){u.nodeName==="FORM"&&o(u),"querySelectorAll"in u&&typeof u.querySelectorAll=="function"&&Array.from(u.querySelectorAll("form")).map(o)})})})).observe(document.body,{subtree:!0,childList:!0})):r.loggerProvider.warn("Form interaction tracking requires a later version of @amplitude/analytics-browser. Form interaction events are not tracked."),[2]})})},execute:function(r){return p(void 0,void 0,void 0,function(){return v(this,function(s){return[2,r]})})},teardown:function(){return p(void 0,void 0,void 0,function(){return v(this,function(r){return n?.disconnect(),i(),[2]})})}}},se=function(n){if(typeof n=="string")return n},An=function(){var n,e=[],t=function(r,s,o){r.addEventListener(s,o),e.push({element:r,type:s,handler:o})},i=function(){e.forEach(function(r){var s=r.element,o=r.type,c=r.handler;s?.removeEventListener(o,c)}),e=[]};return{name:"@amplitude/plugin-file-download-tracking-browser",type:"enrichment",setup:function(r,s){return p(void 0,void 0,void 0,function(){var o,c;return v(this,function(l){return s?typeof document>"u"||(o=function(d){try{u=new URL(d.href,window.location.href)}catch{return}var u,a=c.exec(u.href),g=a?.[1];g&&t(d,"click",function(){var y;g&&s.track(yn,((y={})[mn]=g,y[bn]=u.pathname,y[_n]=d.id,y[In]=d.text,y[wn]=d.href,y))})},c=/\.(pdf|xlsx?|docx?|txt|rtf|csv|exe|key|pp(s|t|tx)|7z|pkg|rar|gz|zip|avi|mov|mp4|mpe?g|wmv|midi?|mp3|wav|wma)$/,Array.from(document.getElementsByTagName("a")).forEach(o),typeof MutationObserver<"u"&&(n=new MutationObserver(function(d){d.forEach(function(u){u.addedNodes.forEach(function(a){a.nodeName==="A"&&o(a),"querySelectorAll"in a&&typeof a.querySelectorAll=="function"&&Array.from(a.querySelectorAll("a")).map(o)})})})).observe(document.body,{subtree:!0,childList:!0})):r.loggerProvider.warn("File download tracking requires a later version of @amplitude/analytics-browser. File download events are not tracked."),[2]})})},execute:function(r){return p(void 0,void 0,void 0,function(){return v(this,function(s){return[2,r]})})},teardown:function(){return p(void 0,void 0,void 0,function(){return v(this,function(r){return n?.disconnect(),i(),[2]})})}}},Vt=!1,Ln=function(n){Vt||n.defaultTracking!==void 0||(n.loggerProvider.warn(`\`options.defaultTracking\` is set to undefined. This implicitly configures your Amplitude instance to track Page Views, Sessions, File Downloads, and Form Interactions. You can suppress this warning by explicitly setting a value to \`options.defaultTracking\`. The value must either be a boolean, to enable and disable all default events, or an object, for advanced configuration. For example:

amplitude.init(<YOUR_API_KEY>, {
  defaultTracking: true,
});

Visit https://www.docs.developers.amplitude.com/data/sdks/browser-2/#tracking-default-events for more details.`),Vt=!0)},jn=function(){var n=J(),e=[],t=function(r,s){n&&(n.addEventListener(r,s),e.push({type:r,handler:s}))},i=function(){e.forEach(function(r){var s=r.type,o=r.handler;n&&n.removeEventListener(s,o)}),e=[]};return{name:"@amplitude/plugin-network-checker-browser",type:"before",setup:function(r,s){return p(void 0,void 0,void 0,function(){return v(this,function(o){return r.offline=!navigator.onLine,t("online",function(){r.loggerProvider.debug("Network connectivity changed to online."),r.offline=!1,setTimeout(function(){s.flush()},r.flushIntervalMillis)}),t("offline",function(){r.loggerProvider.debug("Network connectivity changed to offline."),r.offline=!0}),[2]})})},teardown:function(){return p(void 0,void 0,void 0,function(){return v(this,function(r){return i(),[2]})})}}},Cn=function(n){function e(){return n!==null&&n.apply(this,arguments)||this}return G(e,n),e.prototype.init=function(t,i,r){var s,o;return t===void 0&&(t=""),arguments.length>2?(s=i,o=r):typeof i=="string"?(s=i,o=void 0):(s=i?.userId,o=i),L(this._init(h(h({},o),{userId:s,apiKey:t})))},e.prototype._init=function(t){var i,r;return p(this,void 0,void 0,function(){var s,o,c,l=this;return v(this,function(d){var u,a,g,y;switch(d.label){case 0:return this.initializing?[2]:(this.initializing=!0,[4,(u=t.apiKey,a=t,g=this,a===void 0&&(a={}),p(void 0,void 0,void 0,function(){var _,P,b,w,x,S,I,K,Z,B,D,C,ue,X,ae,A,ee,ye,m,Ve,Fe,Qe,$e,Ke,Be,ze,Je,Ye,Ze,We,Ge,He,Xe,et,tt,nt,it,rt,ot;return v(this,function(ce){var st,ut,at;switch(ce.label){case 0:return _=a.identityStorage||Te,A={},_===Te?[3,1]:(b="",[3,5]);case 1:return(ye=(ee=a.cookieOptions)===null||ee===void 0?void 0:ee.domain)!==null&&ye!==void 0?(w=ye,[3,4]):[3,2];case 2:return[4,p(void 0,void 0,void 0,function(){var te,ne,M,V,me,be,le;return v(this,function(Y){switch(Y.label){case 0:return[4,new De().isEnabled()];case 1:if(!Y.sent()||!st&&typeof location>"u")return[2,""];for(te=(st??location.hostname).split("."),ne=[],M="AMP_TLDTEST",V=te.length-2;V>=0;--V)ne.push(te.slice(V).join("."));V=0,Y.label=2;case 2:return V<ne.length?(be={domain:"."+(me=ne[V])},[4,(le=new De(be)).set(M,1)]):[3,7];case 3:return Y.sent(),[4,le.get(M)];case 4:return Y.sent()?[4,le.remove(M)]:[3,6];case 5:return Y.sent(),[2,"."+me];case 6:return V++,[3,2];case 7:return[2,""]}})})];case 3:w=ce.sent(),ce.label=4;case 4:b=w,ce.label=5;case 5:return P=h.apply(void 0,[(A.domain=b,A.expiration=365,A.sameSite="Lax",A.secure=!1,A.upgrade=!0,A),a.cookieOptions]),[4,(ut=x=En(a.identityStorage,P),(at=(Ve=(m=a.cookieOptions)===null||m===void 0?void 0:m.upgrade)===null||Ve===void 0||Ve)===void 0&&(at=!0),p(void 0,void 0,void 0,function(){var te,ne,M,V,me,be,le,Y,Ft;return v(this,function(ke){switch(ke.label){case 0:return te="".concat("amp","_").concat(u.substring(0,6)),[4,ut.getRaw(te)];case 1:return(ne=ke.sent())?at?[4,ut.remove(te)]:[3,3]:[2,{optOut:!1}];case 2:ke.sent(),ke.label=3;case 3:return V=(M=U(ne.split("."),6))[0],me=M[1],be=M[2],le=M[3],Y=M[4],Ft=M[5],[2,{deviceId:V,userId:hn(me),sessionId:Ae(le),lastEventId:Ae(Ft),lastEventTime:Ae(Y),optOut:!!be}]}})}))];case 6:return S=ce.sent(),[4,x.get(bt(u))];case 7:return I=ce.sent(),K=Ue(),Z=(Ke=($e=(Qe=(Fe=a.deviceId)!==null&&Fe!==void 0?Fe:K.deviceId)!==null&&Qe!==void 0?Qe:I?.deviceId)!==null&&$e!==void 0?$e:S.deviceId)!==null&&Ke!==void 0?Ke:pe(),B=(Be=I?.lastEventId)!==null&&Be!==void 0?Be:S.lastEventId,D=(ze=I?.lastEventTime)!==null&&ze!==void 0?ze:S.lastEventTime,C=(Ye=(Je=a.optOut)!==null&&Je!==void 0?Je:I?.optOut)!==null&&Ye!==void 0?Ye:S.optOut,ue=(Ze=I?.sessionId)!==null&&Ze!==void 0?Ze:S.sessionId,X=(Ge=(We=a.userId)!==null&&We!==void 0?We:I?.userId)!==null&&Ge!==void 0?Ge:S.userId,g.previousSessionDeviceId=(He=I?.deviceId)!==null&&He!==void 0?He:S.deviceId,g.previousSessionUserId=(Xe=I?.userId)!==null&&Xe!==void 0?Xe:S.userId,ae={ipAddress:(tt=(et=a.trackingOptions)===null||et===void 0?void 0:et.ipAddress)===null||tt===void 0||tt,language:(it=(nt=a.trackingOptions)===null||nt===void 0?void 0:nt.language)===null||it===void 0||it,platform:(ot=(rt=a.trackingOptions)===null||rt===void 0?void 0:rt.platform)===null||ot===void 0||ot},[2,new Sn(u,a.appVersion,x,P,a.defaultTracking,Z,a.flushIntervalMillis,a.flushMaxRetries,a.flushQueueSize,_,a.ingestionMetadata,a.instanceName,B,D,a.loggerProvider,a.logLevel,a.minIdLength,a.offline,C,a.partnerId,a.plan,a.serverUrl,a.serverZone,ue,a.sessionTimeout,a.storageProvider,ae,a.transport,a.useBatch,X)]}})}))]);case 1:return s=d.sent(),[4,n.prototype._init.call(this,s)];case 2:return d.sent(),this.setSessionId((r=(i=t.sessionId)!==null&&i!==void 0?i:this.config.sessionId)!==null&&r!==void 0?r:Date.now()),(o=he(t.instanceName)).identityStore.setIdentity({userId:this.config.userId,deviceId:this.config.deviceId}),this.config.offline===null?[3,4]:[4,this.add(jn()).promise];case 3:d.sent(),d.label=4;case 4:return[4,this.add(new Jt).promise];case 5:return d.sent(),[4,this.add(new ln).promise];case 6:return d.sent(),[4,this.add(new un).promise];case 7:return d.sent(),Ln(this.config),ge(this.config.defaultTracking,"fileDownloads")?[4,this.add(An()).promise]:[3,9];case 8:d.sent(),d.label=9;case 9:return ge(this.config.defaultTracking,"formInteractions")?[4,this.add(qn()).promise]:[3,11];case 10:d.sent(),d.label=11;case 11:return ht(this.config.defaultTracking)?(c=Pn(ht((y=this.config).defaultTracking)&&y.defaultTracking&&typeof y.defaultTracking=="object"&&y.defaultTracking.attribution&&typeof y.defaultTracking.attribution=="object"?h({},y.defaultTracking.attribution):{}),[4,this.add(c).promise]):[3,13];case 12:d.sent(),d.label=13;case 13:return gt(this.config.defaultTracking)?[4,this.add(xn(an(this.config))).promise]:[3,15];case 14:d.sent(),d.label=15;case 15:return this.initializing=!1,[4,this.runQueuedFunctions("dispatchQ")];case 16:return d.sent(),o.eventBridge.setEventReceiver(function(_){l.track(_.eventType,_.eventProperties)}),[2]}})})},e.prototype.getUserId=function(){var t;return(t=this.config)===null||t===void 0?void 0:t.userId},e.prototype.setUserId=function(t){if(!this.config){this.q.push(this.setUserId.bind(this,t));return}(t!==this.config.userId||t===void 0)&&(this.config.userId=t,on(t,this.config.instanceName))},e.prototype.getDeviceId=function(){var t;return(t=this.config)===null||t===void 0?void 0:t.deviceId},e.prototype.setDeviceId=function(t){if(!this.config){this.q.push(this.setDeviceId.bind(this,t));return}this.config.deviceId=t,sn(t,this.config.instanceName)},e.prototype.reset=function(){this.setDeviceId(pe()),this.setUserId(void 0)},e.prototype.getSessionId=function(){var t;return(t=this.config)===null||t===void 0?void 0:t.sessionId},e.prototype.setSessionId=function(t){if(!this.config){this.q.push(this.setSessionId.bind(this,t));return}if(t!==this.config.sessionId){var i,r=this.getSessionId(),s=this.config.lastEventTime,o=(i=this.config.lastEventId)!==null&&i!==void 0?i:-1;this.config.sessionId=t,this.config.lastEventTime=void 0,ge(this.config.defaultTracking,"sessions")&&(r&&s&&this.track(Tt,void 0,{device_id:this.previousSessionDeviceId,event_id:++o,session_id:r,time:s+1,user_id:this.previousSessionUserId}),this.config.lastEventTime=this.config.sessionId,this.track(Et,void 0,{event_id:++o,session_id:this.config.sessionId,time:this.config.lastEventTime})),this.previousSessionDeviceId=this.config.deviceId,this.previousSessionUserId=this.config.userId}},e.prototype.extendSession=function(){if(!this.config){this.q.push(this.extendSession.bind(this));return}this.config.lastEventTime=Date.now()},e.prototype.setTransport=function(t){if(!this.config){this.q.push(this.setTransport.bind(this,t));return}this.config.transportProvider=kt(t)},e.prototype.identify=function(t,i){if(Ne(t)){var r=t._q;t._q=[],t=xe(new Se,r)}return i?.user_id&&this.setUserId(i.user_id),i?.device_id&&this.setDeviceId(i.device_id),n.prototype.identify.call(this,t,i)},e.prototype.groupIdentify=function(t,i,r,s){if(Ne(r)){var o=r._q;r._q=[],r=xe(new Se,o)}return n.prototype.groupIdentify.call(this,t,i,r,s)},e.prototype.revenue=function(t,i){if(Ne(t)){var r=t._q;t._q=[],t=xe(new Yt,r)}return n.prototype.revenue.call(this,t,i)},e.prototype.process=function(t){return p(this,void 0,void 0,function(){var i,r;return v(this,function(s){return i=Date.now(),r=yt(this.config.sessionTimeout,this.config.lastEventTime),t.event_type!==Et&&t.event_type!==Tt&&(!t.session_id||t.session_id===this.getSessionId())&&r&&this.setSessionId(i),[2,n.prototype.process.call(this,t)]})})},e}(Ht),O={init:k((f=new Cn).init.bind(f),"init",E(f),T(f,["config"])),add:k(f.add.bind(f),"add",E(f),T(f,["config.apiKey","timeline.plugins"])),remove:k(f.remove.bind(f),"remove",E(f),T(f,["config.apiKey","timeline.plugins"])),track:k(f.track.bind(f),"track",E(f),T(f,["config.apiKey","timeline.queue.length"])),logEvent:k(f.logEvent.bind(f),"logEvent",E(f),T(f,["config.apiKey","timeline.queue.length"])),identify:k(f.identify.bind(f),"identify",E(f),T(f,["config.apiKey","timeline.queue.length"])),groupIdentify:k(f.groupIdentify.bind(f),"groupIdentify",E(f),T(f,["config.apiKey","timeline.queue.length"])),setGroup:k(f.setGroup.bind(f),"setGroup",E(f),T(f,["config.apiKey","timeline.queue.length"])),revenue:k(f.revenue.bind(f),"revenue",E(f),T(f,["config.apiKey","timeline.queue.length"])),flush:k(f.flush.bind(f),"flush",E(f),T(f,["config.apiKey","timeline.queue.length"])),getUserId:k(f.getUserId.bind(f),"getUserId",E(f),T(f,["config","config.userId"])),setUserId:k(f.setUserId.bind(f),"setUserId",E(f),T(f,["config","config.userId"])),getDeviceId:k(f.getDeviceId.bind(f),"getDeviceId",E(f),T(f,["config","config.deviceId"])),setDeviceId:k(f.setDeviceId.bind(f),"setDeviceId",E(f),T(f,["config","config.deviceId"])),reset:k(f.reset.bind(f),"reset",E(f),T(f,["config","config.userId","config.deviceId"])),getSessionId:k(f.getSessionId.bind(f),"getSessionId",E(f),T(f,["config"])),setSessionId:k(f.setSessionId.bind(f),"setSessionId",E(f),T(f,["config"])),extendSession:k(f.extendSession.bind(f),"extendSession",E(f),T(f,["config"])),setOptOut:k(f.setOptOut.bind(f),"setOptOut",E(f),T(f,["config"])),setTransport:k(f.setTransport.bind(f),"setTransport",E(f),T(f,["config"]))};O.add,O.extendSession,O.flush,O.getDeviceId,O.getSessionId,O.getUserId,O.groupIdentify,O.identify,O.init,O.logEvent,O.remove,O.reset,O.revenue,O.setDeviceId,O.setGroup,O.setOptOut,O.setSessionId,O.setTransport,O.setUserId;var Mn=O.track}}]);
